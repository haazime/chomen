var autoSaveWait = <%= Rails.env == 'test' ? 1 : 2000 %>;

var autoSaveTimeoutId;
var submitForm = function(form) {
  if (autoSaveTimeoutId) clearTimeout(autoSaveTimeoutId);
  autoSaveTimeoutId = setTimeout(function() {
    $.rails.handleRemote(form);
  }, autoSaveWait);
}

var autoSaveHandler = function() {
  $(document).on('input', 'textarea[data-auto-save]', function() {
    var form = $(this).closest('form');
    submitForm(form);
  });
}
